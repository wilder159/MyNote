
串口通信是一种常见的串行通信方式，仅用一条发送线和接收线就能将数据以位进行传输的一种通信方式。一般有三条线，发送线、接收线，以及地线。
对于通讯协议，我们也以分层的方式来理解，最基本的是把它分为物理层和协议层。物理层规定通讯系统中具有机械、电子功能部分的特性， 确保原始数据在物理媒体的传输。协议层主要规定通讯逻辑，统一收发双方的数据打包、解包标准。
# 1 物理层
------

常见电平:

| 通信标准     | 电平标准                                                         |
| -------- | ------------------------------------------------------------ |
| 5V TTL电平 | 逻辑0  小于0.5v <br>逻辑1:  大于2.4v至5v                              |
| rs232    | 逻辑0是+3-至+15v <br>逻辑1是-3- 至 -15v                              |
| rs485    | 差分信号<br>逻辑“1”以两线间的电压差为+(2～6)V表示；<br>逻辑“0”以两线间的电压差为-(2～6)V表示。 |
其他电平参考：[[各种电平]]
串口转232需要转化芯片 max232
接口信号电平比RS232降低了，就不易损坏接口电路的芯片，且该电平与TTL电平兼容，可方便与TTL 电路连接。
# 2 协议层
--------
在串口通信的协议层中，规定了数据包的内容，它由起始位、数据位、校验位、停止位组成。
串口数据包的基本组成:
[[../_resources/2.串口/750543b3f859ef1db5159ece1d7ae1ad_MD5.jpeg|Open: Pasted image 20241014152949.png]]
![[../_resources/2.串口/750543b3f859ef1db5159ece1d7ae1ad_MD5.jpeg]]
* 波特率:本章中主要讲解的是串口异步通讯，异步通讯中由于没有时钟信号(如前面讲解的DB9接口中是没有时钟信号的)， 所以两个通讯设备之间需要约定好波特率，即每个码元的长度，以便对信号进行解码， 图串口数据包的基本组成中用虚线分开的每一格就是代表一个码元。常见的波特率为4800、9600、115200等。
* 起始位和停止位:串口通讯的一个数据包从起始信号开始，直到停止信号结束。数据包的起始信号由一个逻辑0的数据位表示， 而数据包的停止信号可由0.5、1、1.5或2个逻辑1的数据位表示，只要双方约定一致即可。
* 有效数据:在数据包的起始位之后紧接着的就是要传输的主体数据内容，也称为有效数据，有效数据的长度常被约定为5、6、7或8位长。
* 校验位:在有效数据之后，有一个可选的数据校验位。由于数据通信相对更容易受到外部干扰导致传输数据出现偏差， 可以在传输过程加上校验位来解决这个问题。校验方法有奇校验(odd)、偶校验(even)、0校验(space)、1校验(mark)以及无校验(noparity)。
# 3 STM32的USART
--------
## 3.1 ceshi
