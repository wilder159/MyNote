> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [www.cnblogs.com](https://www.cnblogs.com/yanghong-hnu/p/4705755.html)

**bss 段：**
----------

 **bss 段（bss segment）**通常是指用来存放程序中未初始化的全局变量的一块内存区域。

　　bss 是英文 Block Started by Symbol 的简称。

　　bss 段属于静态内存分配。 
**data 段：**
-----------

 **数据段（data segment）**通常是指用来存放程序中已初始化的全局变量的一块内存区域。

　　数据段属于静态内存分配。 
**text 段：**
-----------

 **代码段（code segment/text segment）**通常是指用来存放程序执行代码的一块内存区域。

　　这部分区域的大小在程序运行前就已经确定，并且内存区域通常属于只读 (某些架构也允许代码段为可写，即允许修改程序)。

　　在代码段中，也有可能包含一些只读的常数变量，例如字符串常量等。
**堆（heap）：**
------------

　　堆是用于存放进程运行中被动态分配的内存段，它的大小并不固定，可动态扩张或缩减。

　　当进程调用 malloc 等函数分配内存时，新分配的内存就被动态添加到堆上（堆被扩张）；

　　当利用 free 等函数释放内存时，被释放的内存从堆中被剔除（堆被缩减）。
**栈 (stack)**
--------------

　　 栈又称堆栈，是用户存放程序临时创建的局部变量，

　　也就是说我们函数括弧 “{}” 中定义的变量（但不包括 static 声明的变量，static 意味着在数据段中存放变量）。

　　除此以外，在函数被调用时，其参数也会被压入发起调用的进程栈中，并且待到调用结束后，函数的返回值也会被存放回栈中。

　　由于栈的先进先出 (FIFO) 特点，所以栈特别方便用来保存 / 恢复调用现场。

　　从这个意义上讲，我们可以把堆栈看成一个寄存、交换临时数据的内存区。 

* * *

**一个程序本质上都是由 bss 段、data 段、text 段三个组成的。**

　　这样的概念，不知道最初来源于哪里的规定，但在当前的计算机程序设计中是很重要的一个基本概念。

　　而且在嵌入式系统的设计中也非常重要，牵涉到嵌入式系统运行时的内存大小分配，存储单元占用空间大小的问题。

    在采用段式内存管理的架构中（比如 intel 的 80x86 系统），bss 段通常是指用来存放程序中未初始化的全局变量的一块内存区域，

　　一般在初始化时 bss 段部分将会清零。bss 段属于静态内存分配，即程序一开始就将其清零了。

    比如，在 C 语言之类的程序编译完成之后，已初始化的全局变量保存在. data 段中，未初始化的全局变量保存在. bss 段中。

　　text 和 data 段都在可执行文件中（在嵌入式系统里一般是固化在镜像文件中），由系统从可执行文件中加载；

　　而 bss 段不在可执行文件中，由系统初始化。

* * *

【例】
---

两个小程序如下：  
程序 1:

```
int ar[30000];
void main()
{
    ......
}
```

  
程序 2:

```
int ar[300000] = {1, 2, 3, 4, 5, 6 };
void main()
{
    ......
}
```

发现程序 2 编译之后所得的.exe 文件比程序 1 的要大得多。当下甚为不解，于是手工编译了一下，并使用了 /FAs 编译选项来查看了一下其各自的.asm， 发现在程序 1.asm 中 ar 的定义如下： _BSS SEGMENT  
     ?ar@@3PAHA DD 0493e0H DUP (?)  ; ar  
_BSS ENDS  
而在程序 2.asm 中，ar 被定义为： _DATA SEGMENT  
     ?ar@@3PAHA DD 01H  ; ar  
                DD 02H  
                DD 03H  
                ORG $+1199988  
_DATA ENDS  
区别很明显，一个位于.bss 段，而另一个位于.data 段，两者的区别在于： 全局的未初始化变量存在于.bss 段中，具体体现为一个占位符； 全局的已初始化变量存于.data 段中； 而函数内的自动变量都在栈上分配空间； .bss 是不占用.exe 文件空间的，其内容由操作系统初始化（清零）； .data 却需要占用，其内容由程序初始化。因此造成了上述情况。 bss 段（未手动初始化的数据）并不给该段的数据分配空间，只是记录数据所需空间的大小； bss 段的大小从可执行文件中得到 ，然后链接器得到这个大小的内存块，紧跟在数据段后面。 data 段（已手动初始化的数据）则为数据分配空间，数据保存在目标文件中； data 段包含经过初始化的全局变量以及它们的值。当这个内存区进入程序的地址空间后全部清零。   包含 data 段和 bss 段的整个区段此时通常称为数据区。