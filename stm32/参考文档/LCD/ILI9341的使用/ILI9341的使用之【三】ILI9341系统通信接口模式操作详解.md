> 本文由 [简悦 SimpRead](http://ksria.com/simpread/) 转码， 原文地址 [blog.csdn.net](https://blog.csdn.net/weixin_45499326/article/details/113620791)

[《ILI9341 的使用之【一】TFT-LCD 原理（转载）》](https://blog.csdn.net/weixin_45499326/article/details/113567280)  
[《ILI9341 的使用之【二】ILI9341 介绍》](https://blog.csdn.net/weixin_45499326/article/details/113571104)  
[《ILI9341 的使用之【三】ILI9341 系统通信接口模式操作详解》](https://blog.csdn.net/weixin_45499326/article/details/113620791)  
[《ILI9341 的使用之【四】RGB 接口操作详解》](https://blog.csdn.net/weixin_45499326/article/details/113678283)  
[《ILI9341 的使用之【五】命令一》](https://blog.csdn.net/weixin_45499326/article/details/113718511)  
[《ILI9341 的使用之【六】命令二》](https://blog.csdn.net/weixin_45499326/article/details/113837122)  
[《ILI9341 的使用之【七】实体面板案例 - arduino 2.4inch TFT Touch Shield》](https://blog.csdn.net/weixin_45499326/article/details/113992657)  
[《ILI9341 的使用之【八】ASCII 字符显示及驱动分析》](https://blog.csdn.net/weixin_45499326/article/details/114605760)  
[《ILI9341 的使用之【九】BG2312 字库》](https://blog.csdn.net/weixin_45499326/article/details/114776453)

MCU 系统接口共 4 类 12 种模式，具体内容及选择方式详见上一篇的 4.1。这里不再累述。接下来对这 12 种模式的部分实现细节做进一步的解释。

一、系统通信接口之 8080-I 系列并行接口
-----------------------

ILI9341 提供 8080-I/808II 的 8 位，9 位，16 位，18 位的并行系统接口，和 3、4 线的串行系统接口用于串行数据的输入。以上接口的选择是靠 IM[3:0] 扩展引脚的设置。而像素颜色的数据的位次序由指令 3Ah(Pixel Format Set) 的 DBI[2:0] 参数设置。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/a6cb4a6fbdd6f4bd5bb1644a6980f1b5_MD5.png]]

### 1.1、8080-I [Series](https://so.csdn.net/so/search?q=Series&spm=1001.2101.3001.7020) Parallel interface

ILI9341 可以通过 MCU 8080-I 系列并行接口（分别为 8 位 / 9 位 / 16 位 / 18 位）的方式进行访问。  
CSX(片选，LOW 有效）被用来使能或禁止 ILI9341 芯片的功能。  
RESX（LOW 有效）是一个外部复位信号。  
WRX 是并行数据的写选通。  
RDX 是并行数据的读选通。  
数据总线 D[17:0] 是并行数据总线。  
D/CX 是数据或命令选择的信号，当 D/CX=‘1’，D[17:0] 上的内容是显示 RAM 数据或命令的参数。当 D/CX='0’时，D[17:0] 是 命令  
当 WRX 信号处于上升沿时，ILI9341 锁存输入数据。

8080-I 接口模式的选择，由引脚 IM3=0 决定，IM[2:0] 则决定了总线的使用宽度。具体如下表：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/d44464732e8f277b1242b98a957f1635_MD5.png]]  
上表中的 8080 MCU 8-bit bus interface I 是本系列重点讲解的模式。

### 1.2、写时序

在一次写周期中，WRX 信号完成一次从高到低，再从低到高。在写周期中，在 WRX 的上升沿到来时，显示模块获得主控制器送来的信息。在这其间主控必须已把信息写入总线中。当 D/DX 信号被设为低电平时，总线上的信息被理解为命令。当 D/CX 信号被设为高电平时，总线上的信息被理解为 RAM 数据或命令的参数。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/c4660dee81ad2ca8694293fe49ac2fb4_MD5.png]]  
下图为写操作的完整时序图，注意两次数据写 D/CX 的不同电平使 D[17:0] 总线上数据被解释成不同的含义。当片选信号 CSX=‘H’时，所有信号变化都被忽略。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/47646b7dda36da31337fd442df4dc17d_MD5.png]]

### 1.3、读操作时序

在一次读周期中，RDX 信号完成一次从高到低，再从低到高。在读周期中，在 RDX 的上升沿到来时，主控制器获得显示模块送来的信息。在这其间显示模块须已把信息写入总线中。当 D/DX 信号被设为低电平时，总线上的信息被理解为命令。当 D/CX 信号被设为高电平时，总线上的信息被理解为 RAM 数据或命令的参数。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/1cd88a491e1f8f5de60532e67abf81f9_MD5.png]]  
下图为读操作的完整时序图，注意只有当 D/CX 被拉高时，读数据才是有效的。如果在读周期中 D/CX 被拉低，则 ILI9341 引脚对外将出现高阻态。因此注意下面两次数据读的有效性。第一次读，此时 CSX 片选有效，D/CX 拉高，此时 ILI9341 在总线上的数据是有效数据。第二次读周期，在 RDX 上升沿到来前，CSX 片选信号已无效。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/277e66205c463be7192deea06d4f555a_MD5.png]]

### 1.4 8-bit 并行 MCU 接口

ILI9341r 8080-I 系统的 8-bit 并行总线接口的使用是通过设置外部引脚 IM[3:0]为 “0000” 实现。下面的图展示了 MCU 系统接口 8080-I 的例子：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/ac15af8fa73010b3660ee9a793722497_MD5.png]]  
不同的显示数据格式可用于下面列出的两种彩色深度。  
-65K 色，RGB5，6，5-bits 输入数据  
-262K 色，RGB6，6，6 -bits 输入数据

**65K 色：每像素 16-bitt(RGB 5-6-5 bits 输入）**  
当 3Ah 指令设置寄存器 DBI[2:0]值为 “101” 时， 一个像素（有三个子像素，即红绿兰三个点）显示数据由 2 个字节来传送。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/2c52b08d3bd356931a41c8a504251d73_MD5.png]]  
**262K 色：每像素 18 位（RGB 6-6-6 bits 输入）**  
当 3Ah 指令设置寄存器 DBI[2:0]值为 “110” 时，一个像素（3 个子像素）的显示数据由 3 个字节来传送  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/a08fb42302c5e6f1edcb42dc787b01ad_MD5.png]]  
（说明：由于硬件接口是 8bits，而像素的 RGB 三色数据占的位数大于 8。因此传送像素颜色数据就需要多字节对应表示一个像素的颜色数据。该对应关系的设置由指令 3Ah-Pixel Format Set 设置）

### 1.5 9 位并行 MCU 接口

通过设置硬件引脚 IM[3:0] 为 “0010”，选择 ILI9341 的 8080-I 系统的 9 位并行总线接口。如下：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/26e86e326e4ad88de6aa8bbc3b07cc76_MD5.png]]  
**65K color: 16-bit/pixel (RGB 5-6-5 bits input)**  
当 3Ah 寄存器的 DBI[2:0] 位被设置为 “101”，一个像素（三个子像素）的显示数据由两个单位（每单位 9bit 位）来传送：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/563b1e4ee9b401dc12f8d284a9b1c31e_MD5.png]]  
**262K color: 18-bit/pixel (RGB 6-6-6 bits input)**  
当 3Ah 寄存器的 DBI[2:0] 位设置为 “110”，2 个像素（6 个子像素）的显示数据由 4 个单位（每单位 9bit 位）来传送  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/2a66407defa5abc8be9e22900c0dcc12_MD5.png]]  
或：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/03214f98c3e90fecf3fe202df5489963_MD5.png]]

### 1.6 16 位并行 MCU 接口（省略）

### 1.7 18 位并行 MCU 接口（省略）

### 1.8 6 位并行 RGB 接口（省略）

二、系统通信接口之 8080-II 系列并行接口（省略）
----------------------------

三、系统通信接口之串行接口
-------------

### 3.1、串行接口概述

该接口的选择是由 IM[3:0] 完成的。下表详述：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/202fb2cbb7a0db5e82a0a4ccd9a76b0c_MD5.png]]  
ILI9341 支持 3 线 9 位和 4 线 8 位的双向串行接口用于在主控与 ILI9341 之间通信。  
3 线串行模式由 CSX(片选，LOW 有效)，SCL(串口时钟)、SDA 或 SDI/SDO（串行数据输入输出引脚，模式由 IM3=0 或 1 确定，具体见引脚说明）组成。  
4 线串行模式由 D/CX(数据 / 命令选择)、CSX(片选)、SCL(时钟)、SDA 或 SDI/SDO（串行数据输入输出引脚，模式由 IM3=0 或 1 确定，具体见引脚说明）组成。  
D[17:0]不使用时，必须连接到 GND。串行时钟 (SCL) 仅用于单片机的接口, 所以如果没有通信时时钟可以中止它。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/29c2a9913646cf4365f1b0f4971d5b23_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/11e0574c2040d7952a30e817949c76e1_MD5.png]]

### 3.2 写周期时序

接口的写模式意味着从主机写命令或数据到 ILI9341。3 线串行数据包包含了一个数据 / 命令选择位（D/CX) 和一个传送字节。（注意，这里是一个数据 / 命令的选择位，是 bit，不是前面所说到的 D/CX 引脚）。  
如果 D/CX 位是 “low”，传送的字节就被理解为命令字节。如果 D/CX 位是 “high”，这个传送的字节就被存储为显示数据或命令参数。  
任何指令能以任意顺序被发送给 ILI9341，并且最高有效位（MSB）选被发送。当 CSX=‘high’时，串行接口被初始化。在这种状态下，SCL 时钟脉冲和 SDA 数据都是无效的。一个 CSX 上的下降沿会使能串行接口，并且表明数据传送的开始。具体看下面详线的数据格式：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/4ac9e1bec1287269541d0b4bfda9a0c2_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/248353794f8c8ead2a33b77a83c5461a_MD5.png]]  
主机处理器驱动 CSX 引脚为低电平，并且在 SDA 线上设定 D/CX 位。这一位被 ILI9341 在 SCL 引脚 上的第一个上升沿读取。在紧接着的 SCL 引脚的下降沿，MSB（最高有效位）数据位（D7) 被写到 SDA 上。在又紧接着的下降沿，D6 位被写到 SDA 上。如果 D/CX 引脚有被使用，则一个读周期是 8 位一个字节的宽度。3 或 4 线串行接口写时序详见下图：  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/a4f03b753d167239b2236bbfbd74d3b0_MD5.png]]

#### 3 线的两种色彩深度

![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/eb316b5c38170e40332ae3c898046623_MD5.png]]  
注意 1：16 位色深的像素数据。  
注意 2：最高有效位是：红色 4，绿色 5 兰色 4  
注意 3：最低有效位都是 0  
注意 4：“-” 号不去关心，代表能被设置成 0 或 1

![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/d9e464a137e6f0ec43c61a8cfec2ded7_MD5.png]]  
注意 1：18 位色深的像素数据。  
注意 2：最高有效位是：红色 5，绿色 5 兰色 5  
注意 3：最低有效位都是 0  
注意 4：“-” 号不去关心，代表能被设置成 0 或 1  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/c652c39c90fa34909ad323f54a9b09d3_MD5.png]]

![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/59a812b9dbd4aafbd4257e5effafd895_MD5.png]]

#### 3.3 4 线的两种色深

![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/210351ab27e347ab55fad94a45bf120a_MD5.png]]  
注意 1：16 位色深的像素数据。  
注意 2：最高有效位是：红色 4，绿色 5 兰色 4  
注意 3：最低有效位都是 0  
注意 4：“-” 号不去关心，代表能被设置成 0 或 1

![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/eaf3e49091edb1c0493b407db705fa27_MD5.png]]  
注意 1：18 位色深的像素数据。  
注意 2：最高有效位是：红色 5，绿色 5 兰色 5  
注意 3：最低有效位都是 0  
注意 4：“-” 号不去关心，代表能被设置成 0 或 1  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/f1cc0ad67df078bd2ccfd8320070be54_MD5.png]]

### 3.3、读周期时序

接口的读模式意味着主机从 ILI9341 读取寄存器的参数或显示数据。主机必须发送命令（读 ID 或读寄存器命令）然后接着有字节会被回传。ILI9341 在 SCL 的上升沿锁住 SDA 上的输入数据，然后在 SCL 的下降沿移位 SDA 上的输出数据。  
主机在读的命令发出后，SDA 线必须设置为三态并且该状态转换不能迟于命令字的最后一位的下降沿。读模式有三种传输命令数据的类型，分别与 8-/24-/32-bit 三种数据类型对应的命令码。  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/812f622f9301ac321d28dd01010ed738_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/c67629c95b4e694533619aae2ae0d1b9_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/23a3de8892c7a927124d143fa6adcaab_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/9b2d4a434aebe8e3a8511cb8d848950d_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/08508bc88608a49b63017779abb4d8a4_MD5.png]]  
![[../../../../_resources/ILI9341的使用之【三】ILI9341系统通信接口模式操作详解/e95e79b677eacdcb43808f3de5211a41_MD5.png]]